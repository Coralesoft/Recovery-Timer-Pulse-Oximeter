<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Recovery-Time Oximeter</title>
  <style>
    body { font-family: sans-serif; max-width: 720px; margin: 2rem auto; padding: 1rem; line-height: 1.5; }
    h1, h2 { color: #006666; }
    pre { background: #f4f4f4; padding: 1rem; overflow-x: auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    .banner { background: #e0f7fa; padding: 1rem; border-left: 6px solid #0097a7; }
  </style>
</head>
<body>
  <h1>Recovery-Time Pulse Oximeter</h1>
  <div class="banner">
    <strong>Max's Technological Outcome Project ‚Äî NZ Digital Tech 2025</strong><br>
    This site shows project results and explanations from a Max built recovery timer using an ESP32 and pulse oximeter sensor.
  </div>

  <h2>üìä Sample CSV Output</h2>
  <pre>
Session,Start Time,Duration (s),Min SpO2 (%),Max HR (bpm),Target Time (s)
1,2025-08-22 10:31,42,93,132,36
2,2025-08-22 10:45,51,92,128,44
  </pre>

  <h2>üß† Summary</h2>
  <ul>
    <li>Tracks oxygen and heart rate during recovery</li>
    <li>Shows live values, detects target reached, stores results</li>
    <li>1602A LCD output + buzzer cues</li>
  </ul>

  <h2>üß∞ Wiring Diagram</h2>
  <p>Below is a simplified wiring layout showing how the ESP32 connects to the MAX30102 sensor, the 1602A LCD display, and the user button.</p>
  <img src="ESP32-Diagram-Final1.svg" alt="Wiring Diagram with 1602A LCD and ESP32" style="width:100%; max-width:700px; border: 1px solid #ccc; padding: 5px; background: #f9f9f9;" />

  <h2 id="demos">üì∑ Demo & tests</h2>
<p>This project is demonstrated in stages, then assembled at the end to show the full journey.</p>

<ol>
  <li id="demo-lcd"><strong>LCD Smoke Test</strong> ‚Äî I¬≤C display initialises and shows text. <em>Artefacts:</em> photos + short clip.</li>
  <li id="demo-button"><strong>Button Input</strong> ‚Äî Debounced reads via <code>INPUT_PULLUP</code>.</li>
  <li id="demo-max30102"><strong>MAX30102 Bring-up</strong> ‚Äî Raw IR/Red samples stream without I¬≤C errors.</li>
  <li id="demo-filter"><strong>Filtering & Averaging</strong> ‚Äî Smoothed SpO‚ÇÇ/HR; reduced noise.</li>
  <li id="demo-threshold"><strong>Target Detect + Buzzer</strong> ‚Äî Threshold triggers and audible cue.</li>
  <li id="demo-logging"><strong>Data Logging</strong> ‚Äî CSV with session summary.</li>
  <li id="demo-integrated"><strong>Integration Test</strong> ‚Äî All modules working together.</li>
  <li id="demo-final"><strong>Final Assembly</strong> ‚Äî Enclosure and user flow.</li>
</ol>

<h3>Stage 1 ‚Äî LCD Smoke Test</h3>
<p><em>Goal:</em> prove the LCD works with the ESP32 at 3.3V I¬≤C (SDA=21, SCL=22). <em>Pass:</em> crisp text, steady for ‚â•60s.</p>

<figure>
  <img src="photos/lcd-test-1.jpeg" alt="LCD showing 'Reading Finger' screen" style="width:100%;max-width:720px;border:1px solid #ccc;padding:4px;background:#f9f9f9;">
  <figcaption>LCD test ‚Äî runtime screen.</figcaption>
</figure>

<figure>
  <img src="photos/lcd-test-2.jpeg" alt="LCD showing startup screen 'Max's Oxy Meter'" style="width:100%;max-width:720px;border:1px solid #ccc;padding:4px;background:#f9f9f9;">
  <figcaption>LCD test ‚Äî startup screen.</figcaption>
</figure>

<video controls preload="metadata" style="width:100%;max-width:720px;border:1px solid #ccc;">
  <source src="videos/lcd-test.mov" type="video/quicktime">
  <source src="videos/lcd-test.mov" type="video/mp4">
  Your browser can‚Äôt play the embedded clip. <a href="videos/lcd-test.mov">Download the video</a>.
</video>
<h3 id="demo-button">Stage 2 ‚Äî Button Test</h3>
<p><em>Goal:</em> verify button input on GPIO18 with internal pull-up enabled.</p>
<p><em>Method:</em> Wire button between GPIO18 and GND. Program reports <code>Pressed</code> / <code>Released</code> to Serial Monitor.</p>
<p><em>Pass:</em> 50 presses without false triggers.</p>

<figure>
  <img src="photos/button-test-serial.png" alt="Serial Monitor showing button pressed/released output" style="width:100%;max-width:720px;border:1px solid #ccc;padding:4px;background:#f9f9f9;">
  <figcaption>Button test ‚Äî serial output matches presses.</figcaption>
</figure>

<h3 id="demo-buzzer">Stage 3 ‚Äî Buzzer Test</h3>
<p><em>Goal:</em> confirm audible output from buzzer on GPIO19.</p>
<p><em>Method:</em> GPIO19 drives a 3.3 V active buzzer. Code pulses HIGH for 200 ms every second.</p>
<p><em>Pass:</em> buzzer beeps once per second, clearly audible.</p>

<video controls preload="metadata" style="width:100%;max-width:720px;border:1px solid #ccc;">
  <source src="videos/buzzer-test.mov" type="video/quicktime">
  <source src="videos/buzzer-test.mov" type="video/mp4">
  Your browser can‚Äôt play this clip. <a href="videos/buzzer-test.mov">Download</a>.
</video>
<h3 id="demo-oled">Stage 4A ‚Äî OLED UI</h3>
<p>Replaced the 1602 with a 0.91" SSD1306 OLED (I¬≤C @ 0x3C). Clean, high-contrast text at 3.3 V.</p>

<figure>
  <img src="photos/oled-mock-up.jpg"
       alt="OLED showing Oxy and HR mock values"
       style="max-width:500px;border:1px solid #ccc;padding:4px;background:#fafafa;">
  <figcaption>OLED Mock-up Screenshot</figcaption>
</figure>

<h2 id="max30102">ü©∫ Adding the MAX30102 (SpO‚ÇÇ + Heart Rate)</h2>
<p><strong>Goal:</strong> wire the MAX30102 to the ESP32, prove it‚Äôs alive on I¬≤C, and stream raw data before integrating the SpO‚ÇÇ/HR algorithm.</p>

<h3>Wiring (ESP32 ‚Üí MAX30102)</h3>
<table>
  <thead><tr><th>MAX30102</th><th>ESP32 pin</th><th>Notes</th></tr></thead>
  <tbody>
    <tr><td><strong>VIN</strong></td><td><strong>3V3</strong></td><td>3.3&nbsp;V only (do <em>not</em> use 5&nbsp;V)</td></tr>
    <tr><td><strong>GND</strong></td><td><strong>GND</strong></td><td>Common ground</td></tr>
    <tr><td><strong>SDA</strong></td><td><strong>GPIO21 (D21)</strong></td><td>I¬≤C data</td></tr>
    <tr><td><strong>SCL</strong></td><td><strong>GPIO22 (D22)</strong></td><td>I¬≤C clock</td></tr>
    <tr><td><strong>INT</strong></td><td><strong>GPIO19 (D19)</strong></td><td>Optional, active-low ‚Äúdata ready‚Äù</td></tr>
  </tbody>
</table>

<figure>
  <img src="photos/max30102-wired.jpg" alt="MAX30102 wired to ESP32 (3V3, GND, SDA=21, SCL=22, INT=19)" style="width:100%;max-width:720px;border:1px solid #ccc;padding:4px;background:#f9f9f9;">
  <figcaption>MAX30102 wiring as built.</figcaption>
</figure>

<h3>Bring-up steps</h3>
<ol>
  <li>Run an I¬≤C scanner with <code>Wire.begin(21,22)</code>. <em>Pass:</em> device at <strong>0x57</strong>.</li>
  <li>Flash the minimal check sketch. <em>Pass:</em> IR/RED values change with a finger on the sensor.</li>
</ol>

<h4>Minimal check sketch</h4>
<pre><code>// Libraries: SparkFun MAX3010x (MAX30105.h)
#include &lt;Wire.h&gt;
#include &lt;MAX30105.h&gt;
constexpr int PIN_SDA=21, PIN_SCL=22, PIN_INT=19;
MAX30105 max;
void setup(){
  Serial.begin(115200); delay(200);
  Wire.begin(PIN_SDA, PIN_SCL);
  if(!max.begin(Wire, I2C_SPEED_FAST)){ Serial.println("MAX30102 not found"); while(1){} }
  max.setup(0x1F,4,2,100,411,4096); // brightness, avg, mode, rate, width, adc
  max.setPulseAmplitudeRed(0x1F); max.setPulseAmplitudeIR(0x1F);
  pinMode(PIN_INT, INPUT_PULLUP);
  Serial.println("MAX30102 ready");
}
void loop(){
  long ir=max.getIR(), red=max.getRed();
  Serial.print("IR: "); Serial.print(ir); Serial.print("  RED: "); Serial.println(red);
  delay(50);
}
</code></pre>

<h3>Troubleshooting</h3>
<ul>
  <li><strong>No 0x57 in scan:</strong> check 3V3 power, SDA/SCL, bus at 3.3&nbsp;V, no shorts.</li>
  <li><strong>Zeros/flat line:</strong> raise LED amplitude a little; press finger gently; avoid motion/light leaks.</li>
  <li><strong>INT unused:</strong> OK to poll first; add <code>attachInterrupt</code> on D19 later.</li>
</ul>

<p class="note" style="background:#fffbe6;border-left:4px solid #f0c200;padding:.75rem 1rem;">
  <strong>Not medical advice:</strong> This is an educational project; readings are indicative only.
</p>


  
  <footer><small>¬© 2025 Max Brown | MIT Licensed</small></footer>
</body>
</html>
